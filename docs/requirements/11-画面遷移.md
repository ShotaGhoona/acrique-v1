# ACRIQUE 画面遷移図

## 1. 購入フロー

```mermaid
graph TD
    TOP[トップページ] --> CAT[カテゴリページ]
    CAT --> PROD[商品詳細]
    PROD --> CART[カートに追加]
    CART --> AUTH{ログイン?}
    AUTH -->|No| LOGIN[ログイン]
    LOGIN --> CART
    AUTH -->|Yes| CHECKOUT[購入手続き]
    CHECKOUT --> ADDR{住所登録済?}
    ADDR -->|No| ADDR_MODAL[住所登録モーダル]
    ADDR_MODAL --> CHECKOUT
    ADDR -->|Yes| UPLOAD[データ入稿]
    UPLOAD --> CONFIRM[注文確認]
    CONFIRM --> COMPLETE[注文完了]
```

### 住所未登録時の対応
- チェックアウトページで住所が未登録の場合、ページ遷移ではなく**モーダル**で住所登録を行う
- 住所登録完了後、そのままチェックアウトを継続できる（カートに戻る必要なし）

## 2. データ入稿フロー

```mermaid
graph LR
    subgraph A[注文時入稿]
        A1[チェックアウト] --> A2[入稿] --> A3[注文確定]
    end

    subgraph B[注文後入稿]
        B1[注文完了] --> B2[マイページから入稿] --> B3[運営確認]
        B3 -->|OK| B4[製作開始]
        B3 -->|NG| B2
    end
```

## 3. 注文ステータス（要件変更0111）

```mermaid
stateDiagram-v2
    [*] --> pending: 注文作成（支払い前）

    pending --> confirmed: 支払い成功（入稿不要）
    pending --> reviewing: 支払い成功（入稿あり）

    reviewing --> confirmed: Admin承認
    reviewing --> revision_required: Admin差し戻し

    revision_required --> reviewing: 再入稿

    confirmed --> processing: 製作開始
    processing --> shipped: 発送
    shipped --> delivered: 配達完了

    pending --> cancelled: キャンセル
```

### ステータス一覧

| ステータス | 意味 |
|-----------|------|
| `pending` | 支払い待ち（注文作成〜支払い完了） |
| `reviewing` | 入稿審査中（Admin確認待ち） |
| `revision_required` | 再入稿待ち（Admin差し戻し後） |
| `confirmed` | 製作待ち（審査完了 or 入稿不要） |
| `processing` | 製作中 |
| `shipped` | 発送済み |
| `delivered` | 完了 |
| `cancelled` | キャンセル |

---

## 4. 画面一覧

### Public（認証不要）

| Path | ページ名 | 状況 |
|------|---------|-----|
| `/` | トップ | 完了 |
| `/about` | About | 完了 |
| `/contact` | お問い合わせ | 完了 |
| `/shop` | 店舗向け | 完了 |
| `/office` | オフィス向け | 完了 |
| `/you` | 個人向け | 完了 |
| `/[category]/[id]` | 商品詳細 | 完了 |
| `/guide` | ご利用ガイド | - |
| `/faq` | FAQ | - |
| `/privacy` | プライバシーポリシー | - |
| `/terms` | 利用規約 | - |
| `/law` | 特商法表記 | - |
| `/login` | ログイン | 既存 |
| `/register` | 会員登録 | - |
| `/password-reset` | パスワードリセット依頼 | - |
| `/password-reset/confirm` | パスワード再設定 | - |

### Authenticated（認証必要）

| Path | ページ名 | 状況 |
|------|---------|-----|
| `/mypage` | マイページ | 既存 |
| `/mypage/orders` | 注文履歴 | - |
| `/mypage/orders/[id]` | 注文詳細 | - |
| `/mypage/orders/[id]/upload` | データ入稿 | - |
| `/mypage/profile` | プロフィール | - |
| `/mypage/addresses` | 配送先管理 | - |
| `/cart` | カート | - |
| `/checkout` | 購入手続き | - |
| `/checkout/upload` | データ入稿 | - |
| `/checkout/confirm` | 注文確認 | - |
| `/checkout/complete` | 注文完了 | - |

---

## 5. 管理画面フロー

```mermaid
graph TD
    LOGIN[管理者ログイン] --> DASH[ダッシュボード]
    DASH --> ORDERS[注文管理]
    DASH --> PRODUCTS[商品管理]
    DASH --> USERS[顧客管理]
    DASH --> UPLOADS[入稿データ管理]

    ORDERS --> ORDER_DETAIL[注文詳細]
    ORDER_DETAIL --> STATUS[ステータス更新]
    ORDER_DETAIL --> UPLOAD_REVIEW[入稿確認]

    PRODUCTS --> PROD_LIST[商品一覧]
    PROD_LIST --> PROD_EDIT[商品編集]
    PROD_LIST --> PROD_NEW[商品追加]
```

### Admin（管理画面）

| Path | ページ名 | 状況 |
|------|---------|-----|
| `/admin/login` | 管理者ログイン | - |
| `/admin` | ダッシュボード | - |
| `/admin/orders` | 注文一覧 | - |
| `/admin/orders/[id]` | 注文詳細・編集 | - |
| `/admin/products` | 商品一覧 | - |
| `/admin/products/new` | 商品追加 | - |
| `/admin/products/[id]` | 商品編集 | - |
| `/admin/uploads` | 入稿データ一覧 | - |
| `/admin/uploads/[id]` | 入稿確認・承認 | - |
| `/admin/users` | 顧客一覧 | - |
| `/admin/users/[id]` | 顧客詳細 | - |
| `/admin/admins` | 管理者一覧 | - |
| `/admin/logs` | 操作ログ | - |
| `/admin/settings` | サイト設定 | - |

---

## 6. 入稿データ

| 商品タイプ | データ | 形式 |
|-----------|--------|------|
| ロゴ系 | ロゴデータ | AI, EPS, PDF, SVG |
| QRコード系 | URL or 画像 | URL / PNG |
| 写真系 | 写真 | JPG, PNG（300dpi+） |
| 名入れ系 | テキスト | フォーム入力 |
