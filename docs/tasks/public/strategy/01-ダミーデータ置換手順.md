# ダミーデータ置換手順書

## 概要

初期UIプロトタイプで使用したハードコーディングデータを、DB設計に基づいたダミーデータに置き換える作業手順。

バックエンドAPI接続時にスムーズに移行できる構造を維持する。

---

## 前提条件

### 参照すべき資料

| 資料 | パス | 用途 |
|------|------|------|
| DB設計 | `docs/requirements/12-データベース設計.md` | 型定義の参考 |
| API設計 | `docs/requirements/13-API設計.md` | レスポンス形式の参考 |
| 画面遷移 | `docs/requirements/11-画面遷移.md` | ページ一覧の確認 |
| デザインシステム | `docs/rules/design/design-system.md` | UIスタイルガイド |

### ディレクトリ構造

```
frontend/src/
├── shared/
│   ├── domain/           # 固定データ（カテゴリ等）
│   │   └── category/
│   │       ├── data/categories.ts    # カテゴリ固定データ
│   │       └── model/types.ts        # 型定義
│   └── dummy-data/       # ダミーデータ（API置換対象）
│       ├── products.ts
│       ├── users.ts
│       ├── cart.ts
│       ├── orders.ts
│       ├── estimates.ts
│       └── uploads.ts
├── widgets/
│   └── layout/ui/
│       ├── Header.tsx
│       └── Footer.tsx
└── ...
```

---

## 手順

### Step 1: ダミーデータファイルの作成

`frontend/src/shared/dummy-data/` に以下のファイルを作成。

#### 1.1 型定義のルール

```typescript
// TODO: 後で消す - API接続時にこのファイル全体を削除

/**
 * 商品 ダミーデータ
 * @see docs/requirements/12-データベース設計.md
 */

// DB設計のカラム名に合わせてsnake_caseで定義
export interface Product {
  id: string;
  category_id: string;    // ← snake_case
  name: string;
  name_ja: string;
  base_price: number;
  // ...
}
```

#### 1.2 ヘルパー関数の作成

```typescript
// TODO: 後で消す - API接続時にAPIクライアントに置換

export const getProductById = (id: string): Product | undefined => {
  return products.find((p) => p.id === id);
};

export const getProductsByCategory = (categoryId: string): Product[] => {
  return products.filter((p) => p.category_id === categoryId);
};
```

#### 1.3 作成するファイル一覧

| ファイル | 対応テーブル | 主要な型 |
|----------|-------------|----------|
| `products.ts` | products, product_* | Product, ProductImage, ProductOption... |
| `users.ts` | users, addresses | User, Address |
| `cart.ts` | cart_items | CartItem, Cart |
| `orders.ts` | orders, order_items | Order, OrderItem, OrderDetail |
| `estimates.ts` | estimates, estimate_items | Estimate, EstimateItem |
| `uploads.ts` | uploads | Upload |

---

### Step 2: 固定データの配置

カテゴリなど変更頻度の低いデータは `shared/domain/` に配置。

```
shared/domain/category/
├── data/categories.ts    # 固定データ
└── model/types.ts        # 型定義
```

```typescript
// categories.ts - これはAPI化しない固定データ

export const categories: Record<CategoryId, CategoryWithFeatures> = {
  shop: {
    id: 'shop',
    name: 'For Shop',
    nameJa: '店舗向け',
    tagline: '世界観を、置く。',
    // ...
  },
  // ...
};
```

---

### Step 3: 既存コンポーネントの置換

#### 3.1 ハードコーディングを特定

```typescript
// Before: ハードコーディング
const menuData = {
  shop: {
    title: 'For Shop',
    items: [
      { name: 'QR Code Cube', href: '/shop/qr-cube' },
      // ...
    ],
  },
};
```

#### 3.2 ダミーデータをインポート

```typescript
// After: ダミーデータを使用
import { categories, getCategoryIds } from '@/shared/domain/category/data/categories';
import { getProductsByCategory } from '@/shared/dummy-data/products';

// TODO: 後で消す - API接続時にuseSWR等に置換
const getMenuProducts = (categoryId: CategoryId) => {
  return getProductsByCategory(categoryId).slice(0, 3);
};
```

#### 3.3 コンポーネント内で使用

```tsx
{categoryIds.map((categoryId) => {
  const category = categories[categoryId];
  const products = getMenuProducts(categoryId);

  return (
    <div key={categoryId}>
      <h3>{category.name}</h3>
      {products.map((product) => (
        <Link key={product.id} href={`/${categoryId}/${product.id}`}>
          {product.name_ja}
        </Link>
      ))}
    </div>
  );
})}
```

---

### Step 4: 置換対象コンポーネント一覧

| コンポーネント | 置換内容 |
|---------------|---------|
| `Header.tsx` | menuData → categories + products |
| `Footer.tsx` | productLinks → categories |
| `CategoryPage.tsx` | categoryData → categories |
| `ProductPage.tsx` | productData → products |
| `CategoryProductsSection.tsx` | products一覧 |
| `ProductHeroSection.tsx` | product詳細 |
| `RelatedProductsSection.tsx` | 関連商品 |

---

### Step 5: 新規ページの作成

既存ページが使用していないがチェックリストにあるページを作成。

#### 5.1 静的ページ（API不要）

| パス | page-component | 内容 |
|------|----------------|------|
| `/guide` | `GuidePage.tsx` | ご利用ガイド |
| `/faq` | `FAQPage.tsx` | よくある質問 |
| `/privacy` | `PrivacyPage.tsx` | プライバシーポリシー |
| `/terms` | `TermsPage.tsx` | 利用規約 |
| `/law` | `LawPage.tsx` | 特商法表記 |

#### 5.2 動的ページ（API必要）

後でダミーデータを使って作成:

| パス | 使用データ |
|------|-----------|
| `/cart` | cart.ts |
| `/mypage/orders` | orders.ts |
| `/mypage/orders/[id]` | orders.ts |
| `/checkout/*` | cart.ts, orders.ts |
| `/estimate/*` | estimates.ts |

---

## 注意事項

### TODO コメントの挿入

API接続時に削除・置換する箇所には必ずコメントを入れる:

```typescript
// TODO: 後で消す - API接続時に削除
import { products } from '@/shared/dummy-data/products';

// TODO: 後で消す - useSWRに置換
const product = getProductById(productId);
```

### インポートパスの統一

```typescript
// 固定データ
import { categories } from '@/shared/domain/category/data/categories';
import type { CategoryId } from '@/shared/domain/category/model/types';

// ダミーデータ（後で消す）
import { getProductById } from '@/shared/dummy-data/products';
```

### 型定義の分離

ダミーデータファイル内の型定義は、API接続後も使い回せる場合がある。
その場合は `shared/api/types/` などに移動を検討。

---

## チェックリスト

### ダミーデータ作成

- [x] products.ts（商品 + 関連テーブル）
- [x] users.ts（ユーザー + 住所）
- [x] cart.ts（カート）
- [x] orders.ts（注文 + 明細）
- [x] estimates.ts（見積もり + 明細）
- [x] uploads.ts（入稿データ）

### コンポーネント置換

- [x] Header.tsx
- [x] Footer.tsx
- [ ] CategoryPage.tsx
- [ ] ProductPage.tsx
- [ ] CategoryProductsSection.tsx
- [ ] ProductHeroSection.tsx
- [ ] その他widgets

### 静的ページ作成

- [x] /guide
- [x] /faq
- [x] /privacy
- [x] /terms
- [x] /law

---

## API接続時の作業

1. `shared/dummy-data/` 内のファイルを削除
2. `// TODO: 後で消す` のコメントを検索
3. 各箇所をAPIクライアント（useSWR等）に置換
4. 型定義を `shared/api/types/` に移動（必要に応じて）
