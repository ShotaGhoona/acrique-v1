# 広告CLI 既存プロジェクト調査

Meta/Google広告をCLIやコードで管理している既存プロジェクトの調査結果。

---

## 1. 公式SDK

### Meta広告 (facebook-python-business-sdk)

**リポジトリ**: https://github.com/facebook/facebook-python-business-sdk

#### 設計思想
- **CRUDパターン**: Create, Read, Update, Delete の統一インターフェース
- **グラフAPI抽象化**: `AbstractObject` → `AbstractCrudObject` の継承構造
- **自動生成コード**: `adobjects/` 配下はAPIスキーマから自動生成

#### ディレクトリ構造
```
facebook-python-business-sdk/
├── facebook_business/
│   ├── adobjects/          # 広告オブジェクト定義（自動生成）
│   │   ├── campaign.py
│   │   ├── adset.py
│   │   ├── ad.py
│   │   └── ...
│   ├── api.py              # APIクライアント
│   └── session.py          # セッション管理
├── examples/               # 使用例
└── tests/
```

#### ベストプラクティス
- マルチユーザー対応時は `FacebookSession` を個別に管理
- バッチ処理で複数API呼び出しを効率化（`FacebookAdsApiBatch`）
- App Secret Proof を有効化（セキュリティ）

---

### Google広告 (google-ads-python)

**リポジトリ**: https://github.com/googleads/google-ads-python

#### 設計思想
- **gRPCベース**: 高速な通信とストリーミング対応
- **YAML設定**: `google-ads.yaml` で認証情報を一元管理
- **サービス指向**: 各機能がServiceとして分離

#### ディレクトリ構造
```
google-ads-python/
├── google/ads/googleads/
│   ├── client.py           # メインクライアント
│   └── ...
├── examples/
│   ├── basic_operations/   # 基本CRUD
│   │   ├── get_campaigns.py
│   │   └── ...
│   ├── campaign_management/
│   │   ├── add_complete_campaigns_using_batch_job.py
│   │   ├── create_experiment.py
│   │   └── ...
│   └── advanced_operations/
├── google-ads.yaml         # 設定ファイルテンプレート
└── tests/
```

#### 設定ファイル (google-ads.yaml)
```yaml
developer_token: "YOUR_DEVELOPER_TOKEN"
client_id: "YOUR_CLIENT_ID"
client_secret: "YOUR_CLIENT_SECRET"
refresh_token: "YOUR_REFRESH_TOKEN"
login_customer_id: "YOUR_LOGIN_CUSTOMER_ID"
```

---

## 2. MCP (Model Context Protocol) サーバー

LLMから広告APIを操作するための新しいアプローチ。

### Google Ads MCP Server

**リポジトリ**: https://github.com/google-marketing-solutions/google_ads_mcp

#### 設計思想
- **LLM統合**: Gemini等から自然言語でAPI操作
- **uvパッケージマネージャー**: モダンな依存関係管理

#### ディレクトリ構造
```
google_ads_mcp/
├── ads_mcp/                # MCPサーバー実装
├── tests/
├── google-ads.yaml
├── pyproject.toml
└── uv.lock
```

---

### Meta Ads MCP Server

**リポジトリ**: https://github.com/Erriccc/meta-ads-mcp-python

#### 設計思想
- **二重配置**: リモート（ノーコード）とローカル（開発者向け）
- **25+ツール提供**: キャンペーン、広告セット、クリエイティブ管理
- **明示的確認**: 変更操作は全て確認を要求

#### ディレクトリ構造
```
meta-ads-mcp-python/
├── meta_ads_mcp/           # MCPサーバー実装
├── examples/
├── tests/
├── docs/
│   ├── LOCAL_INSTALLATION.md
│   └── META_API_NOTES.md
└── pyproject.toml
```

---

## 3. CLIツール

### Google Ads API Developer Assistant

**リポジトリ**: https://github.com/googleads/google-ads-api-developer-assistant

#### 設計思想
- **自然言語インターフェース**: Gemini CLI拡張として動作
- **コード生成**: GAQL・Python/PHP/Rubyコードを自動生成
- **直接実行**: 生成コードをターミナルから即実行

#### ディレクトリ構造
```
google-ads-api-developer-assistant/
├── .gemini/
│   └── settings.json       # Gemini設定
├── api_examples/           # APIリクエスト/レスポンス例
├── saved_code/             # 生成コード保存先
├── saved_csv/              # CSVエクスポート出力
├── customer_id.txt         # デフォルト顧客ID
└── tests/
```

#### コマンド体系
- 自然言語でクエリ → GAQLに変換
- `/explain`, `/step_by_step` などのカスタムコマンド
- 言語指定: 「in java」で出力言語を切り替え

---

### AdDownloader (Meta広告)

**リポジトリ**: https://github.com/Paularossi/AdDownloader

#### 設計思想
- **対話型CLI**: `python -m AdDownloader.cli` で起動
- **データ変換**: JSON → Excel形式への変換
- **メディアダウンロード**: 広告クリエイティブの自動取得

#### ディレクトリ構造
```
AdDownloader/
├── AdDownloader/           # メインパッケージ
├── data/
├── docs/
├── output/                 # 出力先
├── tests/
├── example.py
└── pyproject.toml
```

---

## 4. サンプルプロジェクト

### Facebook Marketing API Samples

**リポジトリ**: https://github.com/fbsamples/marketing-api-samples (アーカイブ済)

#### 設計思想
- **自己完結型スクリプト**: 各サンプルが独立して実行可能
- **疎結合**: ログイン処理・入力検証から分離
- **Djangoベース**: Webフォームからも実行可能

#### ディレクトリ構造
```
marketing-api-samples/
├── common/                 # 共通コンポーネント
├── common_templates/
├── components/             # UIコンポーネント
├── dash/                   # ダッシュボード
├── muse/                   # メインアプリ
├── samples/
│   ├── samplecode/         # Pythonスクリプト
│   └── views/              # Djangoビュー
└── security/
```

---

## 5. 重要な設計パターンまとめ

| パターン | 説明 | 採用プロジェクト |
|---------|------|-----------------|
| **CRUD抽象化** | 統一インターフェースでオブジェクト操作 | Meta SDK |
| **YAML設定** | 認証・設定を外部ファイル化 | Google Ads SDK |
| **サービス分離** | 機能ごとにServiceクラスを分離 | Google Ads SDK |
| **バッチ処理** | 複数APIコールを1リクエストにまとめる | Meta SDK |
| **MCP統合** | LLMから自然言語で操作 | Google/Meta MCP |
| **自己完結スクリプト** | 各機能を独立したスクリプトとして実装 | FB Samples |

---

## 6. ACRIQUEプロジェクトへの示唆

### 採用すべき設計
1. **YAML設定ファイル**: `campaigns/*.yaml` でキャンペーン定義
2. **プラットフォーム分離**: `platforms/meta/`, `platforms/google/` で実装を分離
3. **共通インターフェース**: 両プラットフォームを統一的に操作できる抽象レイヤー
4. **バッチ処理対応**: 大量クリエイティブのアップロード効率化

### 参考にしないこと
- Djangoベースの複雑なUI（CLIに特化する）
- MCP統合（将来的にはありだが、初期はシンプルに）

---

## 参考リンク

### 公式SDK
- [facebook-python-business-sdk](https://github.com/facebook/facebook-python-business-sdk)
- [google-ads-python](https://github.com/googleads/google-ads-python)

### MCPサーバー
- [google_ads_mcp](https://github.com/google-marketing-solutions/google_ads_mcp)
- [meta-ads-mcp-python](https://github.com/Erriccc/meta-ads-mcp-python)

### CLIツール・サンプル
- [google-ads-api-developer-assistant](https://github.com/googleads/google-ads-api-developer-assistant)
- [AdDownloader](https://github.com/Paularossi/AdDownloader)
- [marketing-api-samples](https://github.com/fbsamples/marketing-api-samples)

### ドキュメント
- [Meta Marketing API](https://developers.facebook.com/docs/marketing-apis/)
- [Google Ads API](https://developers.google.com/google-ads/api/docs/start)
